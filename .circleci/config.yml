version: 2
jobs:
  build:
    docker:
      # specify the version you desire here
      - image: notnoopci/php:7.1.5-browsers

    working_directory: ~/repo

    steps:
      - checkout
      - run:
          name: Setup dependencies
          command: |
            sudo composer self-update
            composer install -n --prefer-dist
            sudo docker-php-ext-enable xdebug
      # run tests!
      #- run: sudo php -dxdebug.coverage_enable=1 vendor/phpunit/phpunit/phpunit --coverage-clover $CIRCLE_ARTIFACTS/citest$tests.xml --configuration phpunit.xml --teamcity
      - run:
          command: |
            mkdir -p ~/phpunit
            phpunit --log-junit ~/phpunit/junit.xml tests
          when: always
            - store_test_results:
              path: ~/phpunit
            - store_artifacts:
              path: ~/phpunit