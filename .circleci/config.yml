version: 2
jobs:
  build:
    docker:
      # specify the version you desire here
      - image: notnoopci/php:7.1.5-browsers

    working_directory: ~/repo

    steps:
      - checkout
      - run:
          name: Setup dependencies
          command: |
            sudo composer self-update
            composer install -n --prefer-dist
            sudo docker-php-ext-enable xdebug
      # run tests!
      # - run: sudo vendor/bin/phpunit --coverage-html $CIRCLE_ARTIFACTS/coverage.html
      - run: php -dxdebug.coverage_enable=1 vendor/phpunit/phpunit/phpunit --coverage-clover $CIRCLE_ARTIFACTS/citest$tests.xml --configuration phpunit.xml --teamcity